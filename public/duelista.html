<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Duelista · IA ultrarrápida</title>
    <link rel="stylesheet" href="/zero/apple-style.css">
    <style>
      body { background: #000; color: #f5f5f7; }
      #game { width: 960px; height: 540px; margin: 20px auto; border-radius: 16px; overflow: hidden; border: 1px solid rgba(255,255,255,.08); }
      .hud { width: 960px; margin: 8px auto 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items: center; }
      .hud .card { padding: 12px 16px; border-radius: 14px; border: 1px solid rgba(255,255,255,.08); background: #111; }
      .muted { color: #a1a1a6; font-size: 13px; }
      .ok { color: #0a84ff; }
      .warn { color: #ffd60a; }
    </style>
  </head>
  <body>
    <div class="hud">
      <div class="card">
        <strong>DUELISTA</strong> — Flechas izquierda/derecha, Shift = dash, Z = ligero, X = pesado (wind‑up), Ctrl = parry/guard.
        <div class="muted">IA: intenciones 8 Hz + interrupciones en wind‑up. Endpoint: <code>/duelista/act</code>.</div>
      </div>
      <div class="card" id="status">Conectando IA...</div>
    </div>
    <div id="game"></div>

    <!-- Fallback CDNs para Phaser -->
    <script>
      console.log('[DUELISTA-HTML] Iniciando carga de Phaser...');
      const phaserCDNs = [
        'https://cdn.jsdelivr.net/npm/phaser@3.80.0/dist/phaser.min.js',
        'https://unpkg.com/phaser@3.80.0/dist/phaser.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/phaser/3.80.0/phaser.min.js'
      ];
      
      let cdnIndex = 0;
      function loadPhaser() {
        if (cdnIndex >= phaserCDNs.length) {
          console.error('[DUELISTA-HTML] ERROR: No se pudo cargar Phaser de ninguna CDN');
          document.getElementById('status').innerHTML = '<span class="warn">Error cargando Phaser</span>';
          return;
        }
        
        const script = document.createElement('script');
        script.src = phaserCDNs[cdnIndex];
        script.onload = () => {
          console.log('[DUELISTA-HTML] Phaser cargado desde:', phaserCDNs[cdnIndex]);
          // Cargar el juego después de que Phaser esté listo
          const gameScript = document.createElement('script');
          gameScript.type = 'module';
          gameScript.src = '/zero/duelista.js';
          document.body.appendChild(gameScript);
        };
        script.onerror = () => {
          console.warn('[DUELISTA-HTML] Fallo CDN:', phaserCDNs[cdnIndex]);
          cdnIndex++;
          loadPhaser();
        };
        document.head.appendChild(script);
      }
      
      loadPhaser();
    </script>
  </body>
</html>
